---
import Head1 from "~/components/Head1.astro";
import Layout from "~/layouts/CenterLayout.astro";
import { getAllPackages, type VPMRepository } from "~/utils/vpm";

const title = "VPM Catalog";

const allRepos: VPMRepository[] = await Astro.glob("~/../vpm/repos/*.json");
const allReleasePackages = getAllPackages(allRepos).filter(p => !p.version.includes('-'));
const allNames = Array.from(new Set(allReleasePackages.map(pkg => pkg.name)));

---
<Layout title={title}>
  <div class="flex flex-col items-center gap-4">
    <Head1>{title}</Head1>
    <p>Known VPM packages and repositories.</p>
    <p><span class="text-4xl">{allNames.length}</span> packages from <span class="text-4xl">{allRepos.length}</span> repositories available.</p>
    <p>(Under development)</p>
    <a class="btn btn-lg btn-wide btn-neutral" href="/packages">View Packages</a>
    <a class="btn btn-lg btn-wide btn-neutral" href="/repositories">View Repositories</a>
  </div>
</Layout>
