---
import Footer from "~/components/Footer.astro";
import Layout from "./Layout.astro"
import Search from "~/components/Search.astro";
import SearchModal from "~/components/SearchModal.astro";
import ThemeIcon from "~/components/ThemeIcon.astro";
import type { Language } from "~/i18n/ui";
import { useTranslations } from "~/i18n/utils";
import { getRelativeLocaleUrl } from "astro:i18n";

interface Props {
  title: string
}

const {title} = Astro.props;
const currentLocale = Astro.currentLocale as Language;
const t = useTranslations(currentLocale);
const homeURL = getRelativeLocaleUrl(currentLocale, "");
const packagesURL = getRelativeLocaleUrl(currentLocale, "packages");
const repositoriesURL = getRelativeLocaleUrl(currentLocale, "repositories");
const aboutURL = getRelativeLocaleUrl(currentLocale, "about");

const searchModalId = "search_modal";
---
<Layout title={title}>
  <SearchModal id={searchModalId} />
  <div class="drawer">
    <input id="my-drawer-3" type="checkbox" class="drawer-toggle" />
    <div class="drawer-content flex flex-col">
      <!-- Navbar -->
      <div class="w-full navbar bg-base-100 sticky top-0 z-10 bg-opacity-90 backdrop-blur transition-shadow duration-100 [transform:translate3d(0,0,0)] shadow-sm">
        <div class="flex-none">
          <label for="my-drawer-3" aria-label="open sidebar" class="btn btn-square btn-ghost">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" class="inline-block w-6 h-6 stroke-current"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
          </label>
        </div>
        <div class="flex-1">
          <a href={homeURL} class="btn btn-ghost text-2xl font-logo font-semibold">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2.5" stroke="currentColor" class="w-6 h-6 text-primary">
              <path stroke-linecap="round" stroke-linejoin="round" d="M12 6.042A8.967 8.967 0 0 0 6 3.75c-1.052 0-2.062.18-3 .512v14.25A8.987 8.987 0 0 1 6 18c2.305 0 4.408.867 6 2.292m0-14.25a8.966 8.966 0 0 1 6-2.292c1.052 0 2.062.18 3 .512v14.25A8.987 8.987 0 0 0 18 18a8.967 8.967 0 0 0-6 2.292m0-14.25v14.25" />
            </svg>
            VPM Catalog
          </a>
          <span class="hidden ml-2 lg:block">
            <Search modalId={searchModalId} />
          </span>
        </div>
        <div class="flex-none hidden lg:block">
          <ul class="menu menu-horizontal">
            <!-- Navbar menu content here -->
            <li><a href={packagesURL}>{t('nav.packages')}</a></li>
            <li><a href={repositoriesURL}>{t('nav.repositories')}</a></li>
          </ul>
        </div>
        <div class="mr-2">
          <ThemeIcon />
        </div>
      </div>
      <!-- Page content here -->
      <slot />
    </div>
    <div class="drawer-side z-20">
      <label for="my-drawer-3" aria-label="close sidebar" class="drawer-overlay"></label>
      <div class="flex flex-col min-h-full bg-base-100">
        <div class="pt-4 px-4">
          <Search modalId={searchModalId} />
        </div>
        <ul class="menu p-4 w-80 min-h-full">
          <!-- Sidebar content here -->
          <li><a href={packagesURL}>{t('nav.packages')}</a></li>
          <li><a href={repositoriesURL}>{t('nav.repositories')}</a></li>
          <li></li>
          <li><a href={aboutURL}>{t('nav.about')}</a></li>
        </ul>
        </div>
    </div>
  </div>
  <Footer />
</Layout>
